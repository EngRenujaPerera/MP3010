<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin-when-cross-origin">
    <title>Advanced Dynamics Course</title>

    <!-- 1. Load Plyr CSS -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />

    <style>
        /* --- General Page Styles --- */
        :root {
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --dark-bg: #0f172a;
            --panel-bg: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #334155;

            --plyr-color-main: #3b82f6;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- Sidebar --- */
        .sidebar {
            width: 360px;
            background-color: var(--panel-bg);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            z-index: 10;
            box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            background: rgba(15, 23, 42, 0.3);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .course-meta h2 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 700;
            color: #fff;
        }

        .course-meta span {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--primary);
            font-weight: 700;
        }

        /* Sidebar Navigation Tabs */
        .sidebar-nav {
            display: flex;
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
            padding: 4px;
            gap: 4px;
        }

        .s-nav-btn {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-muted);
            padding: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .s-nav-btn:hover {
            color: #fff;
            background: rgba(255,255,255,0.05);
        }

        .s-nav-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Sidebar List */
        .sidebar-content {
            list-style: none;
            padding: 0;
            margin: 0;
            overflow-y: auto;
            flex-grow: 1;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 14px 20px;
            cursor: pointer;
            border-bottom: 1px solid rgba(51, 65, 85, 0.3);
            transition: all 0.2s;
            gap: 12px;
        }

        .sidebar-item:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }

        .sidebar-item.active {
            background-color: rgba(59, 130, 246, 0.15);
            border-left: 4px solid var(--primary);
        }

        .item-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            background: rgba(255,255,255,0.05);
            color: var(--text-muted);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .sidebar-item.active .item-icon {
            background: var(--primary);
            color: white;
        }

        .item-info {
            flex-grow: 1;
        }

        .item-info h4 {
            margin: 0;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-main);
            line-height: 1.4;
        }

        .item-info span {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* --- Main Content --- */
        .main-stage {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 0;
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
            overflow-y: auto;
        }

        .content-wrapper {
            width: 100%;
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px;
        }

        .video-container {
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.7);
            background: #000;
            position: relative;
            opacity: 0;
            animation: slideUp 0.6s ease forwards;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Plyr Customizations */
        .plyr {
            --plyr-color-main: var(--primary);
            font-family: 'Segoe UI', sans-serif;
            border-radius: 12px;
        }

        .plyr--full-ui input[type=range] {
            color: var(--primary);
        }

        /* Error Overlay Styles */
        .error-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            z-index: 100;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px;
        }

        .error-overlay h3 { color: #ef4444; font-size: 1.5rem; margin-bottom: 15px; }
        .error-code { font-family: monospace; background: #333; padding: 4px 8px; border-radius: 4px; color: #fbbf24; }

        /* Title below video */
        .current-video-title {
            margin-top: 25px;
            font-size: 1.5rem;
            color: #fff;
            opacity: 0;
            animation: fadeIn 0.5s forwards 0.3s;
        }

        /* --- Resources Section (Tabs) --- */
        .resources-section {
            margin-top: 30px;
            background: var(--panel-bg);
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow: hidden;
            opacity: 0;
            animation: fadeIn 0.5s forwards 0.5s;
        }

        .tabs-header {
            display: flex;
            border-bottom: 1px solid var(--border);
            background: rgba(15, 23, 42, 0.5);
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 16px 24px;
            color: var(--text-muted);
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .tab-btn:hover {
            color: var(--text-main);
            background: rgba(255,255,255,0.05);
        }

        .tab-btn.active {
            color: var(--primary);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary);
        }

        .tab-content {
            padding: 24px;
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .resource-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .resource-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.3);
            margin-bottom: 10px;
            border: 1px solid transparent;
            transition: all 0.2s;
        }

        .resource-item:hover {
            border-color: var(--border);
            background: rgba(15, 23, 42, 0.5);
        }

        .resource-icon {
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .resource-details {
            flex-grow: 1;
        }

        .resource-name {
            display: block;
            font-weight: 500;
            color: var(--text-main);
            margin-bottom: 2px;
        }

        .resource-meta {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .download-btn {
            background: var(--primary);
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
            transition: background 0.2s;
        }

        .download-btn:hover {
            background: var(--primary-hover);
        }

        @keyframes fadeIn { to { opacity: 1; } }

        /* Mobile */
        @media (max-width: 900px) {
            body { flex-direction: column; height: auto; overflow-y: auto; }
            .sidebar { width: 100%; height: auto; max-height: 40vh; order: 2; }
            .main-stage { overflow-y: visible; order: 1; }
            .content-wrapper { padding: 15px; }
            .video-container { border-radius: 0; }
        }
    </style>
</head>
<body>

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="course-meta">
                <span>Course Module</span>
                <h2>Kinematics & Dynamics</h2>
            </div>

            <!-- Sidebar Navigation Tabs -->
            <div class="sidebar-nav">
                <button class="s-nav-btn active" onclick="renderSidebar('lessons')">Lessons</button>
                <button class="s-nav-btn" onclick="renderSidebar('slides')">Slides</button>
                <button class="s-nav-btn" onclick="renderSidebar('papers')">Papers</button>
            </div>
        </div>

        <ul class="sidebar-content" id="sidebar-list">
            <!-- Items injected by JS -->
        </ul>
    </aside>

    <!-- MAIN PLAYER STAGE -->
    <main class="main-stage">
        <div class="content-wrapper">
            <div class="video-container">
                <!-- Error Overlay -->
                <div id="fileProtocolError" class="error-overlay">
                    <h3>‚ö†Ô∏è Setup Required</h3>
                    <p>The Custom Player cannot run directly from a file (<span class="error-code">file://</span>).</p>
                    <p>Please continue running this on your Local Server (localhost).</p>
                </div>

                <!-- Plyr Video Element -->
                <div class="plyr__video-embed" id="player">
                    <iframe
                        src=""
                        allowfullscreen
                        allowtransparency
                        allow="autoplay"
                    ></iframe>
                </div>
            </div>

            <h2 class="current-video-title" id="videoTitle">Select a Lesson</h2>

            <!-- RESOURCES SECTION -->
            <div class="resources-section">
                <div class="tabs-header">
                    <button class="tab-btn active" onclick="switchTab('materials')">Lecture Materials</button>
                    <button class="tab-btn" onclick="switchTab('slides')">Lecture Slides</button>
                    <button class="tab-btn" onclick="switchTab('papers')">Past Papers & Answers</button>
                </div>

                <!-- Tab 1: Lecture Materials -->
                <div id="tab-materials" class="tab-content active">
                    <ul class="resource-list" id="list-materials"></ul>
                </div>

                <!-- Tab 2: Slides -->
                <div id="tab-slides" class="tab-content">
                    <ul class="resource-list" id="list-slides"></ul>
                </div>

                <!-- Tab 3: Past Papers -->
                <div id="tab-papers" class="tab-content">
                    <ul class="resource-list" id="list-papers"></ul>
                </div>
            </div>
        </div>
    </main>

    <!-- 2. Load Plyr JS -->
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

    <script>
        // --- Full Data Structure ---
        const videos = [
            {
                title: "Introduction to Rigid Body Dynamics",
                id: "Nj3Ntg_QupA",
                resources: {
                    materials: [ { name: "Rigid Body Basics Notes", type: "PDF", size: "2.4 MB" }, { name: "Chapter 1 Reading", type: "PDF", size: "1.1 MB" } ],
                    slides: [ { name: "Lecture 1 Slides - Intro", type: "PPTX", size: "5.5 MB" } ],
                    papers: [ { name: "2023 Quiz 1 - Rigid Bodies", type: "PDF", size: "0.5 MB" }, { name: "Quiz 1 Solutions", type: "PDF", size: "0.2 MB" } ]
                }
            },
            {
                title: "Motion Analysis Between Two Frames",
                id: "DccSNMkR3dI",
                resources: {
                    materials: [ { name: "Relative Motion Notes", type: "PDF", size: "1.8 MB" } ],
                    slides: [ { name: "Lecture 2 Slides - Motion", type: "PPTX", size: "4.2 MB" } ],
                    papers: [ { name: "2022 Mid-Term Q3", type: "PDF", size: "0.4 MB" }, { name: "Mid-Term Answer Key", type: "PDF", size: "0.8 MB" } ]
                }
            },
            {
                title: "Inertia Tensor",
                id: "hZ2ODrVfj3g",
                resources: {
                    materials: [ { name: "Inertia Tensor Calculus", type: "PDF", size: "3.2 MB" } ],
                    slides: [ { name: "Lecture 3 Slides - Inertia", type: "PPTX", size: "6.1 MB" } ],
                    papers: [ { name: "2021 Final Exam - Inertia Q", type: "PDF", size: "0.6 MB" } ]
                }
            },
            {
                title: "Translated Frames and Rotation Matrix",
                id: "sIpWLFL5E-s",
                resources: {
                    materials: [ { name: "Rotation Matrix Cheat Sheet", type: "PDF", size: "0.5 MB" } ],
                    slides: [ { name: "Lecture 4 Slides - Matrices", type: "PPTX", size: "3.9 MB" } ],
                    papers: [ { name: "Practice Problem Set A", type: "PDF", size: "1.1 MB" } ]
                }
            },
            {
                title: "Fixed Angle and Euler Representations",
                id: "cwx5lCeYKqM",
                resources: {
                    materials: [ { name: "Euler Angles Visualization", type: "PDF", size: "2.1 MB" } ],
                    slides: [ { name: "Lecture 5 Slides - Euler", type: "PPTX", size: "7.0 MB" } ],
                    papers: [ { name: "2020 Quiz 2 - Angles", type: "PDF", size: "0.4 MB" }, { name: "Quiz 2 Solutions", type: "PDF", size: "0.2 MB" } ]
                }
            },
            {
                title: "Linkage Mechanisms",
                id: "9ZrshlMcU8w",
                resources: {
                    materials: [ { name: "4-Bar Linkage Diagrams", type: "PDF", size: "5.0 MB" }, { name: "Grashof's Law Notes", type: "PDF", size: "1.2 MB" } ],
                    slides: [ { name: "Lecture 6 Slides - Linkages", type: "PPTX", size: "8.2 MB" } ],
                    papers: [ { name: "2019 Final Exam - Mechanisms", type: "PDF", size: "0.9 MB" } ]
                }
            },
            {
                title: "Velocity Vector Diagrams",
                id: "C-Le56Nvhr8",
                resources: {
                    materials: [ { name: "Vector Workbook", type: "PDF", size: "1.5 MB" } ],
                    slides: [ { name: "Lecture 7 Slides - Velocity", type: "PPTX", size: "3.5 MB" } ],
                    papers: [ { name: "Velocity Analysis Problem Set", type: "PDF", size: "0.8 MB" } ]
                }
            },
            {
                title: "Acceleration Vector Diagrams",
                id: "QTHzsPW3Tdg",
                resources: {
                    materials: [ { name: "Acceleration Analysis Guide", type: "PDF", size: "1.9 MB" } ],
                    slides: [ { name: "Lecture 8 Slides - Acceleration", type: "PPTX", size: "4.1 MB" } ],
                    papers: [ { name: "2019 Quiz 3 - Vectors", type: "PDF", size: "0.3 MB" }, { name: "Quiz 3 Answers", type: "PDF", size: "0.1 MB" } ]
                }
            },
            {
                title: "Toothed Gears",
                id: "ZOvJ40aZlC8",
                resources: {
                    materials: [ { name: "Gear Ratio Formulas", type: "PDF", size: "0.8 MB" } ],
                    slides: [ { name: "Lecture 9 Slides - Gears", type: "PPTX", size: "5.5 MB" } ],
                    papers: [ { name: "Gear Design Project Spec", type: "PDF", size: "1.1 MB" } ]
                }
            },
            {
                title: "Gear Trains",
                id: "Mg2bmKAvHZI",
                resources: {
                    materials: [ { name: "Planetary Gear Sets", type: "PDF", size: "2.2 MB" } ],
                    slides: [ { name: "Lecture 10 Slides - Trains", type: "PPTX", size: "4.8 MB" } ],
                    papers: [ { name: "2018 Final - Gear Train Q", type: "PDF", size: "0.5 MB" } ]
                }
            },
            {
                title: "Development of Cam Profile",
                id: "GV1tlgHpMs0",
                resources: {
                    materials: [ { name: "Cam Profile Template", type: "DXF", size: "0.2 MB" } ],
                    slides: [ { name: "Lecture 11 Slides - Cams", type: "PPTX", size: "6.2 MB" } ],
                    papers: [ { name: "2023 Final Exam - Cam Design", type: "PDF", size: "0.7 MB" }, { name: "Final Exam Answers", type: "PDF", size: "1.5 MB" } ]
                }
            }
        ];

        // --- Globals ---
        const sidebarList = document.getElementById('sidebar-list');
        const titleEl = document.getElementById('videoTitle');
        const errorOverlay = document.getElementById('fileProtocolError');

        let player = null;
        let currentMode = 'lessons'; // lessons, slides, papers
        let activeVideoIndex = 0;

        document.addEventListener('DOMContentLoaded', () => {
            if (window.location.protocol === 'file:') errorOverlay.style.display = 'flex';

            player = new Plyr('#player', {
                controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'captions', 'settings', 'pip', 'airplay', 'fullscreen'],
                youtube: { noCookie: true, rel: 0, showinfo: 0, iv_load_policy: 3, modestbranding: 1, origin: window.location.origin }
            });

            // Initial Render
            renderSidebar('lessons');
            loadVideo(0, false);
        });

        // --- Sidebar Logic ---
        function renderSidebar(mode) {
            currentMode = mode;

            // Update Tab UI
            document.querySelectorAll('.s-nav-btn').forEach(btn => {
                const btnMode = btn.innerText.toLowerCase();
                if(btnMode === mode || (btnMode === 'lessons' && mode === 'lessons')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            sidebarList.innerHTML = '';

            // Generate Content based on Mode
            if (mode === 'lessons') {
                videos.forEach((video, index) => {
                    const li = createSidebarItem(index, '‚ñ∂', video.title, 'Video Lesson');
                    sidebarList.appendChild(li);
                });
            }
            else if (mode === 'slides') {
                videos.forEach((video, index) => {
                    // Check if slides exist
                    const slideCount = video.resources.slides.length;
                    const subtitle = slideCount > 0 ? `${slideCount} File(s)` : 'No Slides';
                    const li = createSidebarItem(index, 'üìë', `Slides: ${video.title}`, subtitle);
                    sidebarList.appendChild(li);
                });
            }
            else if (mode === 'papers') {
                videos.forEach((video, index) => {
                    const paperCount = video.resources.papers.length;
                    const subtitle = paperCount > 0 ? `${paperCount} File(s)` : 'No Papers';
                    const li = createSidebarItem(index, 'üìù', `Papers: ${video.title}`, subtitle);
                    sidebarList.appendChild(li);
                });
            }

            // Highlight active item
            updateSidebarHighlight();
        }

        function createSidebarItem(index, icon, title, subtitle) {
            const li = document.createElement('li');
            li.className = 'sidebar-item';
            li.dataset.index = index;
            li.innerHTML = `
                <div class="item-icon">${icon}</div>
                <div class="item-info">
                    <h4>${title}</h4>
                    <span>${subtitle}</span>
                </div>
            `;
            li.onclick = () => handleSidebarClick(index);
            return li;
        }

        function updateSidebarHighlight() {
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
                if (parseInt(item.dataset.index) === activeVideoIndex) {
                    item.classList.add('active');
                }
            });
        }

        function handleSidebarClick(index) {
            activeVideoIndex = index;
            loadVideo(index, true);
            updateSidebarHighlight();

            // If in resource mode, automatically switch the bottom tab to match
            if (currentMode === 'slides') {
                switchTab('slides');
                // Scroll to resources
                document.querySelector('.resources-section').scrollIntoView({behavior: 'smooth'});
            } else if (currentMode === 'papers') {
                switchTab('papers');
                document.querySelector('.resources-section').scrollIntoView({behavior: 'smooth'});
            }
        }

        // --- Video & Content Logic ---
        function loadVideo(index, autoPlay) {
            const video = videos[index];
            player.source = { type: 'video', sources: [ { src: video.id, provider: 'youtube' } ] };
            if (autoPlay) player.play();

            // Update Title
            titleEl.textContent = video.title;
            titleEl.style.animation = 'none';
            titleEl.offsetHeight;
            titleEl.style.animation = 'fadeIn 0.5s forwards';

            // Populate Resources Section
            updateResources(video.resources);
        }

        function updateResources(resources) {
            const generateList = (items, typeIcon) => {
                if (!items || items.length === 0) return `<li style="padding:15px; color:#94a3b8; text-align:center;">No items available.</li>`;
                return items.map(item => `
                    <li class="resource-item">
                        <div class="resource-icon">${typeIcon}</div>
                        <div class="resource-details">
                            <span class="resource-name">${item.name}</span>
                            <span class="resource-meta">${item.type} ‚Ä¢ ${item.size}</span>
                        </div>
                        <a href="#" class="download-btn">Download</a>
                    </li>
                `).join('');
            };

            document.getElementById('list-materials').innerHTML = generateList(resources.materials, 'DOC');
            document.getElementById('list-slides').innerHTML = generateList(resources.slides, 'PPT');
            document.getElementById('list-papers').innerHTML = generateList(resources.papers, 'EXAM');
        }

        // Tab Switching
        window.switchTab = function(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

            document.getElementById('tab-' + tabName).classList.add('active');

            // Highlight active button
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => {
                if(btn.getAttribute('onclick').includes(tabName)) btn.classList.add('active');
            });
        };

    </script>
</body>
</html>